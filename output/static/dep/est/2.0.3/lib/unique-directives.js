/*! 2015 Baidu Inc. All Rights Reserved */
function getNestedVisitor(e){function t(){this._nested=[],this._visitor=new e.visitors.Visitor(this)}function r(e){var t=e;if("-"==e.charAt(1)&&e.indexOf("-",2)>0)t="@"+e.slice(e.indexOf("-",2)+1);return t}var n={"@media":1,"@supports":1,"@document":1},a={"@keyframes":1};return t.prototype={isReplacing:!0,run:function(e){return this._visitor.visit(e)},getPath:function(e){return this._nested.concat([e]).join("/")},visitMedia:function(e){var t=e.features.toCSS({compress:!1});return this._nested.push("@media "+t),e},visitMediaOut:function(){this._nested.pop()},visitDirective:function(e){var t=e.name,i=r(t),s=e;if(n[i])this._nested.push(t+" "+e.value.value);else if(a[i])s=this.uniqueCallback(e);return s},visitDirectiveOut:function(e){if(e){var t=r(e.name);if(n[t])this._nested.pop()}},uniqueCallback:function(e){return e}},t}function getMarkUniqueVisitor(e,t){function r(){this._visitor=new e.visitors.Visitor(this)}var n=getNestedVisitor(e);return r.prototype=new n,r.constructor=r,r.prototype.uniqueCallback=function(e){return t[this.getPath(e.name+" "+e.value.value)]=e,e},r}function getRemoveDuplicateVisitor(e,t){function r(){this._visitor=new e.visitors.Visitor(this)}var n=getNestedVisitor(e);return r.prototype=new n,r.constructor=r,r.prototype.uniqueCallback=function(e){if(t[this.getPath(e.name+" "+e.value.value)]===e)return e;else return void 0},r}module.exports={install:function(e,t){var r={},n=getMarkUniqueVisitor(e,r);t.addVisitor(new n);var a=getRemoveDuplicateVisitor(e,r);t.addVisitor(new a)}};