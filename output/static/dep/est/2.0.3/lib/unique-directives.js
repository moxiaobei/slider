/*! 2015 Baidu Inc. All Rights Reserved */
function getNestedVisitor(e){function t(){this._nested=[],this._visitor=new e.visitors.Visitor(this)}function n(e){var t=e;if("-"==e.charAt(1)&&e.indexOf("-",2)>0)t="@"+e.slice(e.indexOf("-",2)+1);return t}var r={"@media":1,"@supports":1,"@document":1},i={"@keyframes":1};return t.prototype={isReplacing:!0,run:function(e){return this._visitor.visit(e)},getPath:function(e){return this._nested.concat([e]).join("/")},visitMedia:function(e){var t=e.features.toCSS({compress:!1});return this._nested.push("@media "+t),e},visitMediaOut:function(){this._nested.pop()},visitDirective:function(e){var t=e.name,s=n(t),a=e;if(r[s])this._nested.push(t+" "+e.value.value);else if(i[s])a=this.uniqueCallback(e);return a},visitDirectiveOut:function(e){if(e){var t=n(e.name);if(r[t])this._nested.pop()}},uniqueCallback:function(e){return e}},t}function getMarkUniqueVisitor(e,t){function n(){this._visitor=new e.visitors.Visitor(this)}var r=getNestedVisitor(e);return n.prototype=new r,n.constructor=n,n.prototype.uniqueCallback=function(e){return t[this.getPath(e.name+" "+e.value.value)]=e,e},n}function getRemoveDuplicateVisitor(e,t){function n(){this._visitor=new e.visitors.Visitor(this)}var r=getNestedVisitor(e);return n.prototype=new r,n.constructor=n,n.prototype.uniqueCallback=function(e){if(t[this.getPath(e.name+" "+e.value.value)]===e)return e;else return void 0},n}module.exports={install:function(e,t){var n={},r=getMarkUniqueVisitor(e,n);t.addVisitor(new r);var i=getRemoveDuplicateVisitor(e,n);t.addVisitor(new i)}};